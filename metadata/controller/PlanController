{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userAlias": "planController",
        "designer|userClassName": "PlanController",
        "id": "PlanController"
    },
    "designerId": "3cebb1f9-1e3f-4ce1-a430-d2db18adcf91",
    "cn": [
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "mainStage",
                "selector": "#mainStage"
            },
            "designerId": "8b37e158-2337-4267-b002-8cba77818e63"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "ref": "exercisesPanel",
                "selector": "exercisesPanel",
                "xtype": "exercisesPanel"
            },
            "designerId": "b6d28ef6-c59e-46f0-a692-edcf1c4dc27e"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "rightCommandPanel",
                "selector": "#rightCommandPanel"
            },
            "designerId": "a37712e7-d056-4d73-8ec7-2a9fff12675d"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "leftCommandPanel",
                "selector": "#leftCommandPanel"
            },
            "designerId": "2d90f5a6-a52b-448f-9912-37fe80dfbeba"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "mainViewport",
                "selector": "mainViewport"
            },
            "designerId": "0c02d580-9306-41f1-8a3d-385438c461c3"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "ref": "planPanel",
                "selector": "#planPanel",
                "xtype": "planPanel"
            },
            "designerId": "083c8fad-bfb1-4f3e-bc8e-673e562572dc"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "ref": "planEditPanel",
                "selector": "#planEditPanel",
                "xtype": "planEditPanel"
            },
            "designerId": "eb64cc1c-5404-45b6-ad78-2fff325a352c"
        },
        {
            "type": "applicationaction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "callback"
                ],
                "fn": "onClosePlanPanel",
                "implHandler": [
                    "var controller = this;",
                    "",
                    "LanistaTrainer.app.fireEvent('hideStage', function () {",
                    "    controller.getRightCommandPanel().items.each(function (item) {",
                    "        item.hide();",
                    "    });",
                    "    controller.getLeftCommandPanel().items.each(function (item) {",
                    "        item.hide();",
                    "    });",
                    "    controller.getPlanPanel().hide();",
                    "    if (callback instanceof Function) callback();",
                    "});"
                ],
                "name": "closePlanPanel",
                "scope": "this"
            },
            "designerId": "7492bbfd-0def-48f0-a5bd-db7e812eda7c"
        },
        {
            "type": "applicationaction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "planname",
                    "callback"
                ],
                "fn": "onShowPlanPanel",
                "implHandler": [
                    "var controller = this,",
                    "    planExercisesStore = controller.plan.planexercises(),",
                    "    exerciseController = LanistaTrainer.app.getController ( 'ExerciseController' );",
                    "",
                    "controller.planname = planname;",
                    "controller.getPlanPanel().down('planExercisesList').store = planExercisesStore;",
                    "planExercisesStore.setProxy(new Ext.data.proxy.Ajax({",
                    "        url: Ext.ux.ConfigManager.getRoot() + '/tpmanager/planexercises/json',",
                    "        model: 'PlanExercise',",
                    "        noCache: false,",
                    "        reader: {",
                    "            type: 'json',",
                    "            root: 'entries'",
                    "        },",
                    "        writer: {",
                    "            type: 'json',",
                    "            root: 'records'",
                    "        },",
                    "        headers: {",
                    "            user_id: localStorage.getItem(\"user_id\")",
                    "        }",
                    "    }));",
                    "",
                    "for (var i = 0; i < planExercisesStore.filters.length; i++)",
                    "{",
                    "    if (planExercisesStore.filters.items[i].property  == 'day')",
                    "        planExercisesStore.filters.removeAt(i);",
                    "}",
                    "",
                    "planExercisesStore.sort({",
                    "                                property : 'position',",
                    "                                direction: 'ASC'",
                    "                       });",
                    "",
                    "planExercisesStore.load(function(records, operation, success) {",
                    "    var planPanel\t= controller.getPlanPanel(),",
                    "        mainStage\t= controller.getMainStage(),",
                    "        recordsArray = [],",
                    "        tabActiveId = controller.currentDay || controller.getPlanPanel ().down ('tabpanel').child('#d1');",
                    "",
                    "    planPanel.controller = controller;",
                    "    controller.createDayPanels ( controller.plan.data.days );",
                    "",
                    "    mainStage.add( planPanel );",
                    "    planPanel.on('hide', function(component) {",
                    "        component.destroy();",
                    "    }, controller",
                    "                );",
                    "    // **** 1 create the commands",
                    "    controller.showCommands();",
                    "    LanistaTrainer.app.setStandardButtons('closePlanPanelButton');",
                    "",
                    "    // *** 2 Show the panel",
                    "    planPanel.show();",
                    "",
                    "    LanistaTrainer.app.fireEvent('showPlanHeaderUpdate');",
                    "    controller.populateTabsExercisesByDay(records);",
                    "    planPanel.down ('tabpanel').setActiveTab(tabActiveId);",
                    "    LanistaTrainer.app.fireEvent('showStage');",
                    "",
                    "    // *** 4 Callback",
                    "    if (callback instanceof Function) callback();",
                    "",
                    " });",
                    ""
                ],
                "name": "showPlanPanel",
                "scope": "this"
            },
            "designerId": "b9fd5ec6-f156-4497-a8e3-81997946d79f"
        },
        {
            "type": "applicationaction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onShowPlanHeaderUpdate",
                "implHandler": [
                    "",
                    "var controller = this,",
                    "    record = LanistaTrainer.app.currentCustomer,",
                    "    divLogo = '<div class=\"lansita-header-customer-image-not-found\"><div class=\"lansita-header-customer-logo\" style=\"background-image: url(' + Ext.ux.ConfigManager.getServer() + Ext.ux.ConfigManager.getRoot() + '/tpmanager/img/p/'+ record.data.id + '_photo.jpg);\"></div></div>',",
                    "    divInfoCustomer = '<div class=\"lansita-header-customer-name\"> <span class=\"last-name\">' + record.data.last_name + '</span><br> <span class=\"first-name\">' + record.data.first_name +'</span></div>',",
                    "    planPanel\t= controller.getPlanPanel();",
                    "",
                    "planPanel.down ('#planHeader').update(controller.plan.data);",
                    "if (!controller.plan.data.description)",
                    "    Ext.get('planHeaderDescription').setHTML('No description available');",
                    "",
                    "controller.getMainViewport().down(\"#header\").update({",
                    "    info: divLogo + divInfoCustomer,",
                    "    title: controller.planname",
                    "});"
                ],
                "name": "showPlanHeaderUpdate",
                "scope": "this"
            },
            "designerId": "a4e3ea5e-37d9-455d-a8af-afdd412f7fb0"
        },
        {
            "type": "applicationaction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "callback",
                    "userExercises"
                ],
                "fn": "onShowExerciseSelectionView",
                "implHandler": [
                    "var store = Ext.getStore( 'ExerciseStore' ),",
                    "    self = this,",
                    "    mainStage\t\t\t= self.getMainStage(),",
                    "    viewportXCapacity\t= Math.floor(mainStage.getEl().getWidth(true)/187);",
                    "    viewportCapacity\t= Math.floor((mainStage.getEl().getHeight(true)-47)/177) * viewportXCapacity;",
                    "    exercisesPanel\t\t= self.getExercisesPanel();",
                    "",
                    "store.clearFilter();",
                    "if ( userExercises === true )",
                    "{",
                    "    store.filter (new Ext.util.Filter(",
                    "        {",
                    "            property : 'ext_id',",
                    "            value : 'CUST',",
                    "            anyMatch: true",
                    "        }));",
                    "}",
                    "",
                    "store.pageSize = viewportCapacity;",
                    "store.clearFilter(true);",
                    "if ( this.favorite )",
                    "{",
                    "    store.filter( 'ext_id', '\"' + this.favorite.data.objects.replace(/,/g,'\",\"') + '\"' );",
                    "}",
                    "store.sort('name_' + Ext.ux.LanguageManager.lang, 'ASC');",
                    "",
                    "var menuFilters = LanistaTrainer.app.getController('ExercisesController').showExercisesMenu();",
                    "",
                    "this.getRightCommandPanel().add(",
                    "    Ext.create('LanistaTrainer.view.LanistaButton', {",
                    "        text: Ext.ux.LanguageManager.TranslationArray.SEARCH,",
                    "        itemId: 'showExerciseFilterButton',",
                    "        menu: menuFilters,",
                    "        menuButtonAlign: 'right',",
                    "        glyph: '90@Lanista Icons' //Z",
                    "    })",
                    ");",
                    "",
                    "this.getRightCommandPanel().add(",
                    "    Ext.create('LanistaTrainer.view.LanistaButton', {",
                    "        text: Ext.ux.LanguageManager.TranslationArray.BUTTON_OWN_EXERCISES,",
                    "        itemId: 'showSelectionUserExercisesButton',",
                    "        glyph: '97@Lanista Icons' //a",
                    "    })",
                    ");",
                    "this.getRightCommandPanel().add(",
                    "    Ext.create('LanistaTrainer.view.LanistaButton', {",
                    "        text: Ext.ux.LanguageManager.TranslationArray.BUTTON_FAVORITES,",
                    "        itemId: 'showExercisesFavoritesToSelectButton',",
                    "        glyph: '122@Lanista Icons' //z",
                    "    })",
                    ");",
                    "",
                    "exercisesPanel.selection = this.selectionsTab[this.currentDay.id.substring(1)];",
                    "mainStage.add(exercisesPanel);",
                    "LanistaTrainer.app.setStandardButtons('closeExercisesSelectionView');",
                    "exercisesPanel.on('hide', function(component) {",
                    "    component.destroy();",
                    "}, self);",
                    "",
                    "exercisesPanel.headerInfo = '<div class=\"exercises-header\">' + Ext.ux.LanguageManager.TranslationArray.TRAINING_PLAN + ': ' + this.plan.data.name + '</div>';",
                    "exercisesPanel.headerTitle = Ext.ux.LanguageManager.TranslationArray.BUTTON_ADD_EXERCISES;",
                    "exercisesPanel.show();",
                    "",
                    "LanistaTrainer.app.fireEvent('showSearchHeaderUpdate');",
                    "LanistaTrainer.app.fireEvent('showStage');",
                    "",
                    "if ( callback instanceof Function ) callback();"
                ],
                "name": "showExerciseSelectionView",
                "scope": "this"
            },
            "designerId": "6ce49db2-f8bf-4dd3-a81e-28076da631e0"
        },
        {
            "type": "applicationaction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "planname"
                ],
                "fn": "onCreatePlan",
                "implHandler": [
                    "var userId = localStorage.getItem(\"user_id\"),",
                    "    newPlan = Ext.create('LanistaTrainer.model.Plan', {",
                    "    name : ( planname && planname.length > 1 )? planname : Ext.ux.LanguageManager.TranslationArray.PLAN_NAME_DEFAULT,",
                    "    template: 0,",
                    "    customer_id: LanistaTrainer.app.currentCustomer.data.id,",
                    "    trainer_id: userId",
                    "});",
                    "",
                    "newPlan.setProxy(new Ext.data.proxy.Ajax({",
                    "    url: Ext.ux.ConfigManager.getRoot() + '/tpmanager/plan/json',",
                    "    model: 'Plan',",
                    "    noCache: false,",
                    "    reader: {",
                    "        type: 'json',",
                    "        root: 'entries'",
                    "    },",
                    "    writer: {",
                    "        type: 'json',",
                    "        root: 'records',",
                    "        allowSingle: false",
                    "    },",
                    "    headers: {",
                    "        user_id: userId",
                    "    }",
                    "}));",
                    "",
                    "newPlan.save (",
                    "    {",
                    "        callback: function ( record ){",
                    "            LanistaTrainer.app.getController ( 'PlanController' ).plan = record;",
                    "            LanistaTrainer.app.panels[LanistaTrainer.app.panels.length] = 'PlanPanel';",
                    "            LanistaTrainer.app.fireEvent( 'showPlanPanel', planname, 'showCustomerExercisePanel' );",
                    "        }",
                    "    });"
                ],
                "name": "createPlan",
                "scope": "this"
            },
            "designerId": "469caf1e-1bde-4b35-b062-cddeaa970e4b"
        },
        {
            "type": "applicationaction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "callback"
                ],
                "fn": "onCloseExercisesSelectionView",
                "implHandler": [
                    "var controller = this,",
                    "    exercisesPanel = controller.getExercisesPanel();",
                    "",
                    "LanistaTrainer.app.fireEvent('hideStage', function () {",
                    "    controller.getRightCommandPanel().items.each(function (item) {",
                    "        item.hide();",
                    "    });",
                    "    controller.getLeftCommandPanel().items.each(function (item) {",
                    "        item.hide();",
                    "    });",
                    "    exercisesPanel.hide();",
                    "    if (callback instanceof Function) callback();",
                    "});"
                ],
                "name": "closeExercisesSelectionView",
                "scope": "this"
            },
            "designerId": "8e91b87d-c320-44a6-9cda-2d3caa3ee88b"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "callback"
                ],
                "fn": "showCommands",
                "implHandler": [
                    "",
                    "var controller = this;",
                    "",
                    "controller.getRightCommandPanel().items.each(function (item) {",
                    "    item.hide();",
                    "});",
                    "",
                    "this.getRightCommandPanel().add(",
                    "    Ext.create('LanistaTrainer.view.LanistaButton', {",
                    "        text: Ext.ux.LanguageManager.TranslationArray.BUTTON_ADD_EXERCISES,",
                    "        itemId: 'addExerciseButton',",
                    "        userAlias: 'customerButton',",
                    "        glyph: '108@Lanista Icons' //l",
                    "    })",
                    ");",
                    "",
                    "this.getRightCommandPanel().add(",
                    "    Ext.create('LanistaTrainer.view.LanistaButton', {",
                    "        text: Ext.ux.LanguageManager.TranslationArray.BUTTON_PLAN_OPTIONS,",
                    "        itemId: 'showPlanOptionsButton',",
                    "        style: 'float: left;',",
                    "        glyph: '120@Lanista Icons' //x",
                    "    })",
                    ");",
                    "",
                    "",
                    "",
                    ""
                ]
            },
            "designerId": "1d82cff0-19ac-4c98-be3b-f6eaadb80802"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "loadData",
                "implHandler": [
                    ""
                ]
            },
            "designerId": "b3691cac-ccdb-4fbd-8c98-0fd0fb5bb158"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "days"
                ],
                "fn": "createDayPanels",
                "implHandler": [
                    "var tabPanel = this.getPlanPanel ().down ( 'tabpanel' ),",
                    "    controller = this;",
                    "",
                    "var from = 2,",
                    "    to = days,",
                    "    newList = null;",
                    "",
                    "for (from=2; from<=to; from++)",
                    "{",
                    "    tabPanel.insert(tabPanel.items.getCount() -1 , {",
                    "                    xtype: 'planExercisesList',",
                    "                    id: 'd'+from,",
                    "                    title: Ext.ux.LanguageManager.TranslationArray.DAY + ' ' + from,",
                    "                    store: controller.plan.planexercises()",
                    "});",
                    "}"
                ]
            },
            "designerId": "f637c063-cfcc-421e-a0fb-8dc8919d8397"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "records",
                    "callback"
                ],
                "fn": "populateTabsExercisesByDay",
                "implHandler": [
                    "var controller = this,",
                    "    tabPanel = controller.getPlanPanel().down('tabpanel'),",
                    "    recordsArray = [],",
                    "    results,",
                    "    tab;",
                    "",
                    "for ( var i = 1; i < tabPanel.items.length; i++ ) {",
                    "    results = Ext.Array.filter(records, function(item) {",
                    "        return item.data.day === i;",
                    "    });",
                    "    tab = tabPanel.child('#d' + i);",
                    "    for ( var j = 0; j < results.length; j++ ) {",
                    "        recordsArray.push(results[j].data);",
                    "    }",
                    "    if (recordsArray) {",
                    "        if (tab){",
                    "            tab.update(recordsArray);",
                    "            tab.recordsArray = recordsArray;",
                    "        }",
                    "    }",
                    "    recordsArray = [];",
                    "}",
                    "",
                    "",
                    "",
                    ""
                ]
            },
            "designerId": "ccb9ac2e-7eb8-48c2-b193-e790406c863a"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "viewport #closePlanPanelButton",
                "designer|targetType": "LanistaButton",
                "fn": "onclosePlanPanelButtonClick",
                "implHandler": [
                    "this.currentDay = null;",
                    "this.currentExercisePosition = 0;",
                    "this.selectionsTab = [];",
                    "this.plan = null;",
                    "this.planname = '';",
                    "",
                    "LanistaTrainer.app.panels.splice(LanistaTrainer.app.panels.length - 1, 1);",
                    "LanistaTrainer.app.fireEvent('closePlanPanel', function() {",
                    "    LanistaTrainer.app.fireEvent('show' + LanistaTrainer.app.panels[LanistaTrainer.app.panels.length - 1]);",
                    "});",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "7c76e167-c921-4951-8404-6c37f3952934"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "viewport #addExerciseButton",
                "designer|targetType": "LanistaButton",
                "fn": "onAddExerciseButtonClick",
                "implHandler": [
                    "var planDayPanel = this.getPlanPanel ().down ('tabpanel').getActiveTab();",
                    "",
                    "this.currentDay = planDayPanel;",
                    "this.currentExercisePosition = planDayPanel.getStore ().getCount();",
                    "",
                    "if (!this.selectionsTab){",
                    "    this.selectionsTab = [];",
                    "    this.selectionsTab[1] = [];",
                    "}",
                    "if (!this.selectionsTab[planDayPanel.id.substring(1)])",
                    "    this.selectionsTab[planDayPanel.id.substring(1)] = [];",
                    "",
                    "LanistaTrainer.app.panels.splice(LanistaTrainer.app.panels.length - 1, 1);",
                    "LanistaTrainer.app.fireEvent( 'closePlanPanel', function() {",
                    "    LanistaTrainer.app.panels[LanistaTrainer.app.panels.length] = 'ExerciseSelectionView';",
                    "    LanistaTrainer.app.fireEvent( 'showExerciseSelectionView' );",
                    "});"
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "fd00ea2f-ebc6-4c20-9c46-336b8d01efb3"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "viewport #closeExercisesSelectionView",
                "designer|targetType": "LanistaButton",
                "fn": "onCloseExercisesSelectionViewButtonClick",
                "implHandler": [
                    "",
                    "var controller = this,",
                    "    userId = localStorage.getItem(\"user_id\"),",
                    "    currentExercisePosition = controller.currentExercisePosition,",
                    "    currentDay = controller.currentDay.id.substring (1),",
                    "    idExercisePlan,",
                    "    planExercisesItems,",
                    "    exercisesPanel = controller.getExercisesPanel(),",
                    "    userId = localStorage.getItem(\"user_id\");",
                    "",
                    "this.selectionsTab[this.currentDay.id.substring(1)] = exercisesPanel.selection;",
                    "var selection = this.selectionsTab[this.currentDay.id.substring(1)],",
                    "    isCustom = false;",
                    "    storeExercises = Ext.getStore('ExerciseStore');",
                    "",
                    "for ( var i = 0; i < selection.length; i++ ) {",
                    "    if (selection[i][2] === 1) //Record has just saved in previous added",
                    "        continue;",
                    "",
                    "    isCustom = isNaN (selection[i][1].substring (0,1));",
                    "    var newPlanExercise = Ext.create('LanistaTrainer.model.PlanExercise', {",
                    "        exercise_id : isCustom ? 0 : selection [i][0],",
                    "        user_exercise_id : isCustom ? selection [i][0] : 0,",
                    "        plan_id: controller.plan.data.id,",
                    "        day: currentDay,",
                    "        position: (currentExercisePosition + i + 1)",
                    "    });",
                    "",
                    "    newPlanExercise.setProxy(new Ext.data.proxy.Ajax({",
                    "        url: Ext.ux.ConfigManager.getRoot() + '/tpmanager/planexercises/json',",
                    "        model: 'PlanExercise',",
                    "        noCache: false,",
                    "        reader: {",
                    "            type: 'json',",
                    "            root: 'entries'",
                    "        },",
                    "        writer: {",
                    "            type: 'json',",
                    "            root: 'records',",
                    "            allowSingle: false",
                    "        },",
                    "        api: {",
                    "            create: undefined,",
                    "            read: undefined,",
                    "            update: undefined,",
                    "            destroy: Ext.ux.ConfigManager.getServer() + Ext.ux.ConfigManager.getRoot() + '/tpmanager/planexercises/deleteexercise'",
                    "        },",
                    "        headers: {",
                    "            user_id: userId",
                    "        }",
                    "    }));",
                    "",
                    "    if (selection[i][3] !== 'd'){ //'d' indicates that the record must be deleted",
                    "        newPlanExercise.save ();",
                    "        selection[i][2] = 1; // To mark record as saved on server",
                    "    }",
                    "}",
                    "",
                    "setTimeout(function() {",
                    "        if ( currentDay > controller.plan.data.days ) {",
                    "            controller.plan.set ( 'days', currentDay );",
                    "            ",
                    "            controller.plan.setProxy(new Ext.data.proxy.Ajax({",
                    "                url: Ext.ux.ConfigManager.getRoot() + '/tpmanager/plan/json',",
                    "                model: 'Plan',",
                    "                noCache: false,",
                    "                reader: {",
                    "                    type: 'json',",
                    "                    root: 'entries'",
                    "                },",
                    "                writer: {",
                    "                    type: 'json',",
                    "                    root: 'records',",
                    "                    allowSingle: false",
                    "                },",
                    "                headers: {",
                    "                    user_id: userId",
                    "                }",
                    "            }));",
                    "           ",
                    "            ",
                    "            controller.plan.save ({",
                    "                callback: function( changedPlan, operation, success ) {",
                    "                    console.log ( changedPlan );",
                    "                    LanistaTrainer.app.panels.splice(LanistaTrainer.app.panels.length - 1, 1);",
                    "                    LanistaTrainer.app.fireEvent( 'closeExercisesSelectionView', function() {",
                    "                        LanistaTrainer.app.panels[LanistaTrainer.app.panels.length] = 'PlanPanel';",
                    "                        LanistaTrainer.app.fireEvent( 'showPlanPanel', controller.planname, controller.backAction );",
                    "                    });",
                    "                },",
                    "                scope: this",
                    "            });",
                    "        } else {",
                    "            LanistaTrainer.app.panels.splice(LanistaTrainer.app.panels.length - 1, 1);",
                    "            LanistaTrainer.app.fireEvent( 'closeExercisesSelectionView', function() {",
                    "                LanistaTrainer.app.panels[LanistaTrainer.app.panels.length] = 'PlanPanel';",
                    "                LanistaTrainer.app.fireEvent( 'showPlanPanel', controller.planname, controller.backAction );",
                    "            });",
                    "        }",
                    "        controller.favorite = undefined;",
                    "},2500);",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "designerId": "8df30e8b-e969-46ce-b4c0-8efcbecc07b2"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "setHeader",
                "implHandler": [
                    "LanistaTrainer.app.fireEvent('showPlanHeaderUpdate');"
                ]
            },
            "designerId": "0eabe6d6-cb36-4886-bf2a-290cd77e0000"
        }
    ]
}