/*
 * File: app/view/MyExerciseInfoPanel.js
 *
 * This file was generated by Sencha Architect version 3.0.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('LanistaTrainer.view.MyExerciseInfoPanel', {
    extend: 'Ext.form.Panel',
    alias: 'widget.myExerciseInfoPanel',

    requires: [
        'Ext.form.FieldSet',
        'Ext.form.field.ComboBox'
    ],

    cls: 'lanista-myexercise-panel',
    height: 694,
    id: 'myExerciseInfoPanel',
    width: 400,
    bodyPadding: 10,
    header: false,

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'fieldset',
                    cls: 'lanista-myexercise-configuration',
                    id: 'myExercise_configuration',
                    defaultAlign: 'c-c',
                    items: [
                        me.processMyExercise_language({
                            xtype: 'combobox',
                            anchor: '100%',
                            id: 'myExercise_language',
                            name: 'myExercise_language',
                            enableKeyEvents: true,
                            editable: false,
                            listeners: {
                                change: {
                                    fn: me.onMyExercise_languageChange,
                                    scope: me
                                }
                            }
                        }),
                        {
                            xtype: 'textfield',
                            anchor: '100%',
                            cls: 'lanista-field-myexercise',
                            id: 'myExercise_name',
                            hideEmptyLabel: false,
                            labelCls: 'lanista-myexercise-item-label',
                            name: 'myExercise_name'
                        },
                        {
                            xtype: 'textfield',
                            anchor: '100%',
                            cls: 'lanista-field-myexercise',
                            id: 'myExercise_execution',
                            labelCls: 'lanista-myexercise-item-label',
                            name: 'myExercise_execution'
                        },
                        {
                            xtype: 'textfield',
                            anchor: '100%',
                            cls: 'lanista-field-myexercise lanista-field-myexercise-errors',
                            id: 'myExercise_errors',
                            labelCls: 'lanista-myexercise-item-label',
                            name: 'myExercise_errors'
                        }
                    ]
                },
                {
                    xtype: 'combobox',
                    anchor: '100%',
                    cls: 'lanista-field-myexercise',
                    id: 'myExercise_muscle',
                    labelCls: 'lanista-myexercise-item-label',
                    name: 'muscle'
                },
                {
                    xtype: 'combobox',
                    anchor: '100%',
                    cls: 'lanista-field-myexercise',
                    id: 'myExercise_exerciseType',
                    labelCls: 'lanista-myexercise-item-label',
                    name: 'type'
                },
                {
                    xtype: 'combobox',
                    anchor: '100%',
                    cls: 'lanista-field-myexercise lanista-field-myexercise-other',
                    id: 'myExercise_other',
                    labelCls: 'lanista-myexercise-item-label',
                    name: 'addition'
                },
                {
                    xtype: 'container',
                    cls: 'lanista-myExercise-images',
                    id: 'myExercise_images',
                    layout: {
                        type: 'hbox',
                        align: 'stretch'
                    },
                    items: [
                        {
                            xtype: 'container',
                            flex: 1,
                            cls: 'lanista-myExercise-imageleft',
                            id: 'myExercise_imageLeft'
                        },
                        {
                            xtype: 'container',
                            flex: 1,
                            cls: 'lanista-myExercise-imageright',
                            id: 'myExercise_imageRight'
                        }
                    ]
                }
            ],
            listeners: {
                afterrender: {
                    fn: me.onMyExerciseInfoPanelAfterRender,
                    scope: me
                }
            }
        });

        me.callParent(arguments);
    },

    processMyExercise_language: function(config) {
        var server =	'http://' + window.location.host,
            root =		Ext.ux.ConfigManager.getRoot() + '/LanistaTrainerBrowser2.0/';

        config.tpl = Ext.create("Ext.XTemplate",
                                '<tpl for="."><div class="x-boundlist-item"><img src=' + server + root + 'resources/images/flags/{image} /> {LanguageName}</div></tpl>');

        config.displayTpl = Ext.create("Ext.XTemplate",
                                       '<tpl for=".">{LanguageName}</tpl>');

        config.valueField = 'IdLanguage';

        return config;

    },

    onMyExercise_languageChange: function(field, newValue, oldValue, eOpts) {
        LanistaTrainer.app.getController ('MyExerciseInfoController').loadData();
    },

    onMyExerciseInfoPanelAfterRender: function(component, eOpts) {
        var languagesStore = Ext.create('Ext.data.Store', {
                fields: ['image', 'LanguageName', 'IdLanguage'],
                data : [
                    {"image": "es.png", "LanguageName":"Espa√±ol", "IdLanguage":"ES"},
                    {"image": "de.png", "LanguageName":"Deutsch", "IdLanguage":"DE"},
                    {"image": "gb.png", "LanguageName":"English", "IdLanguage":"EN"}
                ]
        }),
            fields = component.getForm().getFields();

        fields.getByKey('myExercise_language').bindStore(languagesStore);
        languagesStore.load();

        fields.getByKey('myExercise_language').setValue(Ext.ux.LanguageManager.lang);
        fields.getByKey('myExercise_muscle').setFieldLabel(Ext.ux.LanguageManager.TranslationArray.FILTER_MUSCLES);
        fields.getByKey('myExercise_exerciseType').setFieldLabel(Ext.ux.LanguageManager.TranslationArray.FILTER_TYPE);
        fields.getByKey('myExercise_other').setFieldLabel(Ext.ux.LanguageManager.TranslationArray.FILTER_ADDITIVES);

        document.getElementsByName("myExercise_name")[0].placeholder = Ext.ux.LanguageManager.TranslationArray.FORM_CUSTOMER_DATA_EMAIL;

        fields.each(function(field)
                    {field.on('change',function(f,n,o)
                              {
                                  //f: field;  n: new value;  o: old value
                                  LanistaTrainer.app.fireEvent('showSavePanel', 'saveSettingsButton', 'cancelSettingsButton');
                              }
                             );
                     field.on('keypress',function(f,e,opts)
                              {
                                  //f: field;  e: key pressed;  o: options
                                  if(e.getKey() == e.ENTER){
                                      if ( !Ext.getCmp('rightCommandPanel').down('#saveSettingsButton').hidden )
                                          Ext.getCmp('rightCommandPanel').down('#saveSettingsButton').fireEvent('click', function() {
                                              f.focus();
                                          });
                                  }
                              }
                             );
                    }
                   );



    }

});