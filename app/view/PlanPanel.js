/*
 * File: app/view/PlanPanel.js
 *
 * This file was generated by Sencha Architect version 3.0.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('LanistaTrainer.view.PlanPanel', {
    extend: 'Ext.panel.Panel',
    alias: 'widget.planPanel',

    requires: [
        'LanistaTrainer.view.PlanExercisesList'
    ],

    height: 250,
    id: 'planPanel',
    width: 400,

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            listeners: {
                afterrender: {
                    fn: me.onPlanPanelAfterRender,
                    scope: me
                }
            }
        });

        me.processPlanPanel(me);
        me.callParent(arguments);
    },

    processPlanPanel: function(config) {
        config.items = [
            {
                xtype: 'component',
                flex: 1,
                itemId: 'planHeader',
                maxHeight: 100,
                tpl: [
                    '<div class="plan-header-description">{description}</div>',
                    '<div class="plan-header-info">',
                    '    <div class="plan-header-attribute">{[Ext.ux.LanguageManager.TranslationArray.CREATED_AT]}:</div><div class="plan-header-value">{[Ext.Date.format ( values.creation_date, \'d, M Y\' )]}</div>',
                    '    <div class="plan-header-attribute">{[Ext.ux.LanguageManager.TranslationArray.FORM_PLAN_TIME]}:</div><div class="plan-header-value">{duration}</div>',
                    '</div>'
                ]
            },
            {
                xtype: 'tabpanel',
                flex: 1,
                cls: 'lanista-exercices-panel',
                itemId: 'exercicesPanel',
                items: [
                    {
                        xtype: 'planExercisesList',
                        id: 'd1'
                    },
                    {
                        xtype: 'container',
                        title: '+',
                        itemId: 'plus'
                    }
                ],
                tabBar: {
                    docked: 'top',
                    html: '<b class="caret" style="-webkit-transform: translate3d(34px, 0px, 0px); "><b class="caret_inner" ></b></b>',
                    itemId: 'mytabbar'
                }
            }
        ];
    },

    onPlanPanelAfterRender: function(component, eOpts) {
        this.controller = LanistaTrainer.app.getController( 'PlanController' );
        //this.down ('tabpanel').child('#d1').title = Ext.ux.LanguageManager.TranslationArray.DAY + ' 1';


        this.down ('tabpanel').items.items[0].el.update('New value');
        console.log(this.down ('tabpanel').items.items[0]);



        //this.down ('tabpanel').items[0].setHTML('Nuevo valor');


        //this.down ('#d1').setStore ( LanistaTrainer.app.getController ( 'PlanController').plan.planexercise().load () );

        if ( LanistaTrainer.app.getController ('PlanController').plan.data.public_template == 1 ) {
            var panelSize = this.down ('tabpanel').getAt (1).getItems ().getCount();
            this.down ('tabpanel').getAt (1).getAt (panelSize-1).hide();
        }
    }

});